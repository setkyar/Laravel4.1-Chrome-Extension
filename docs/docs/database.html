<!doctype html>

<html lang="en">


<!-- Mirrored from laravel.com/docs/database by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 14 Jan 2014 00:41:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <title>Laravel - The PHP Framework For Web Artisans.</title>

    <!-- meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9,chrome=1">
    <meta name="author" content="iKreativ">
    <meta name="description" content="Laravel - The PHP framework for web artisans.">
    <meta name="keywords" content="laravel, php, framework, web, artisans, taylor otwell">

    <!-- favicon -->
    <link rel="shortcut icon" href="../favicon5e1f.png?v=2">

    <!-- we're minifying and combining all our css -->
    <link href="../assets/css/style.css" rel="stylesheet">

    <!-- grab jquery from google cdn. fall back to local if offline -->
    <script src="../../ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../assets/js/jquery.js"><\/script>')</script>

    <!-- prettyprint -->
    <script src="../../google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>

    <!-- load up our js -->
    <script src="../assets/js/plugins.js"></script>
    <script src="../assets/js/application.js"></script>

    <!-- fonts -->
    <script src="../../use.edgefonts.net/source-sans-pro_n3%2ci3%2cn4%2ci4%2cn6%2ci6%2cn7%2ci7.js"></script>
    <script src="../../use.edgefonts.net/source-code-pro.js"></script>

    <!-- some conditionals for ie -->
    <!--[if IE]><link href="assets/css/ie.css" rel="stylesheet" type="text/css" /><![endif]-->

    <!-- HTML5 elements in less than IE9, yes please! -->
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <!-- If less than IE8 add some JS for the webfont icons -->
    <!--[if lt IE 8]><script src="assets/js/ie_font.js"></script><![endif]-->

    <!-- asynchronous google analytics. change UA-XXXXX-X to your site's ID -->
    <script>
        var _gaq=[['_setAccount','UA-23865777-1'],['_trackPageview']];
        (function(d,t){
    		var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        	g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        	s.parentNode.insertBefore(g,s)
    	}(document,'script'));
    </script>
</head>

<body id="index" class="page docs">

	<!-- wrapper -->
    <div id="wrapper">

        <!-- header -->
        <header id="header" role="header">
            <div class="boxed">
                <!-- tagline -->
                <div id="tagline">
                    <h1>Documentation.</h1>
                </div>
                <!-- /tagline -->

                <!-- version -->
                <div id="version">
                    <ul class="nolist">
                                                    <li><a href="http://laravel.com/docs/dev" title="Dev">Dev</a></li>
                            <li class="current"><a href="http://laravel.com/docs/4-1" title="4.1">4.1</a></li>
                            <li><a href="http://laravel.com/docs/4-0" title="4.0">4.0</a></li>
                                            </ul>
                </div>
                <!-- /version -->
            </div>
        </header>
        <!-- /header -->

        <!-- nav -->
    	<nav id="primary">
    	    <div class="boxed">
    	        <div id="logo-head">
    	           <a href="http://laravel.com/"><img src="../assets/img/logo-head.png" alt="Laravel" /></a>
    	        </div>
                <ul>
                    <li><a href="http://laravel.com/">Welcome</a></li>
                    <li class="current-item"><a href="../docs.html" title="Documentation">Documentation</a></li>
                    <li><a href="../api/4.1/index.html" title="Laravel Framework API">API</a></li>
                    <li><a href="https://github.com/laravel/laravel" title="Github">Github</a></li>
                    <li><a href="http://forums.laravel.io/" title="Laravel Forums">Forums</a></li>
                    <li><a href="http://twitter.com/laravelphp" title="Laravel on Twitter">Twitter</a></li>
                </ul>
            </div>
        </nav>
        <!-- /nav -->

        <!-- content -->
        <div id="content">

            <!-- docs -->
            <section id="documentation">
                <article class="boxed">

                    <!-- docs nav -->
                    <nav id="docs">
                        <!-- Pull table of contents -->
                        <ul>
<li>Preface

<ul>
<li><a href="introduction.html">Introduction</a></li>
<li><a href="quick.html">Quickstart</a></li>
<li><a href="releases.html">Release Notes</a></li>
<li><a href="upgrade.html">Upgrade Guide</a></li>
</ul></li>
<li>Getting Started

<ul>
<li><a href="installation.html">Installation</a></li>
<li><a href="configuration.html">Configuration</a></li>
<li><a href="lifecycle.html">Request Lifecycle</a></li>
<li><a href="routing.html">Routing</a></li>
<li><a href="requests.html">Requests &amp; Input</a></li>
<li><a href="responses.html">Views &amp; Responses</a></li>
<li><a href="controllers.html">Controllers</a></li>
<li><a href="errors.html">Errors &amp; Logging</a></li>
</ul></li>
<li>Learning More

<ul>
<li><a href="security.html">Authentication</a></li>
<li><a href="cache.html">Cache</a></li>
<li><a href="extending.html">Core Extension</a></li>
<li><a href="events.html">Events</a></li>
<li><a href="facades.html">Facades</a></li>
<li><a href="html.html">Forms &amp; HTML</a></li>
<li><a href="helpers.html">Helpers</a></li>
<li><a href="ioc.html">IoC Container</a></li>
<li><a href="localization.html">Localization</a></li>
<li><a href="mail.html">Mail</a></li>
<li><a href="packages.html">Package Development</a></li>
<li><a href="pagination.html">Pagination</a></li>
<li><a href="queues.html">Queues</a></li>
<li><a href="security.html">Security</a></li>
<li><a href="session.html">Session</a></li>
<li><a href="ssh.html">SSH</a></li>
<li><a href="templates.html">Templates</a></li>
<li><a href="testing.html">Unit Testing</a></li>
<li><a href="validation.html">Validation</a></li>
</ul></li>
<li>Database

<ul>
<li><a href="database.html">Basic Usage</a></li>
<li><a href="queries.html">Query Builder</a></li>
<li><a href="eloquent.html">Eloquent ORM</a></li>
<li><a href="schema.html">Schema Builder</a></li>
<li><a href="migrations.html">Migrations &amp; Seeding</a></li>
<li><a href="redis.html">Redis</a></li>
</ul></li>
<li>Artisan CLI

<ul>
<li><a href="artisan.html">Overview</a></li>
<li><a href="commands.html">Development</a></li>
</ul></li>
</ul>
                    </nav>
                    <!-- /docs nav -->

                    <!-- docs content -->
                    <div id="docs-content">
                        <h1>Basic Database Usage</h1>

<ul>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#read-write-connections">Read / Write Connections</a></li>
<li><a href="#running-queries">Running Queries</a></li>
<li><a href="#database-transactions">Database Transactions</a></li>
<li><a href="#accessing-connections">Accessing Connections</a></li>
<li><a href="#query-logging">Query Logging</a></li>
</ul>

<p><a name="configuration"></a></p>

<h2>Configuration</h2>

<p>Laravel makes connecting with databases and running queries extremely simple. The database configuration file is <code>app/config/database.php</code>. In this file you may define all of your database connections, as well as specify which connection should be used by default. Examples for all of the supported database systems are provided in this file.</p>

<p>Currently Laravel supports four database systems: MySQL, Postgres, SQLite, and SQL Server.</p>

<p><a name="read-write-connections"></a></p>

<h2>Read / Write Connections</h2>

<p>Sometimes you may wish to use one database connection for SELECT statements, and another for INSERT, UPDATE, and DELETE statements. Laravel makes this a breeze, and the proper connections will always be used whether you are using raw queries, the query builder, or the Eloquent ORM.</p>

<p>To see how read / write connections should be configured, let's look at this example:</p>

<pre><code>'mysql' =&gt; array(
    'read' =&gt; array(
        'host' =&gt; '192.168.1.1',
    ),
    'write' =&gt; array(
        'host' =&gt; '196.168.1.2'
    ),
    'driver'    =&gt; 'mysql',
    'database'  =&gt; 'database',
    'username'  =&gt; 'root',
    'password'  =&gt; '',
    'charset'   =&gt; 'utf8',
    'collation' =&gt; 'utf8_unicode_ci',
    'prefix'    =&gt; '',
),
</code></pre>

<p>Note that two keys have been added to the configuration array: <code>read</code> and <code>write</code>. Both of these keys have array values containing a single key: <code>host</code>. The rest of the database options for the <code>read</code> and <code>write</code> connections will be merged from the main <code>mysql</code> array. So, we only need to place items in the <code>read</code> and <code>write</code> arrays if we wish to override the values in the main array. So, in this case, <code>192.168.1.1</code> will be used as the "read" connection, while <code>192.168.1.2</code> will be used as the "write" connection. The database credentials, prefix, character set, and all other options in the main <code>mysql</code> array will be shared across both connections.</p>

<p><a name="running-queries"></a></p>

<h2>Running Queries</h2>

<p>Once you have configured your database connection, you may run queries using the <code>DB</code> class.</p>

<h4>Running A Select Query</h4>

<pre><code>$results = DB::select('select * from users where id = ?', array(1));
</code></pre>

<p>The <code>select</code> method will always return an <code>array</code> of results.</p>

<h4>Running An Insert Statement</h4>

<pre><code>DB::insert('insert into users (id, name) values (?, ?)', array(1, 'Dayle'));
</code></pre>

<h4>Running An Update Statement</h4>

<pre><code>DB::update('update users set votes = 100 where name = ?', array('John'));
</code></pre>

<h4>Running A Delete Statement</h4>

<pre><code>DB::delete('delete from users');
</code></pre>

<blockquote>
  <p><strong>Note:</strong> The <code>update</code> and <code>delete</code> statements return the number of rows affected by the operation.</p>
</blockquote>

<h4>Running A General Statement</h4>

<pre><code>DB::statement('drop table users');
</code></pre>

<p>You may listen for query events using the <code>DB::listen</code> method:</p>

<h4>Listening For Query Events</h4>

<pre><code>DB::listen(function($sql, $bindings, $time)
{
    //
});
</code></pre>

<p><a name="database-transactions"></a></p>

<h2>Database Transactions</h2>

<p>To run a set of operations within a database transaction, you may use the <code>transaction</code> method:</p>

<pre><code>DB::transaction(function()
{
    DB::table('users')-&gt;update(array('votes' =&gt; 1));

    DB::table('posts')-&gt;delete();
});
</code></pre>

<blockquote>
  <p><strong>Note:</strong> Any exception thrown within the <code>transaction</code> closure will cause the transaction to be rolled back automatically.</p>
</blockquote>

<p>Sometimes you may need to begin a transaction yourself:</p>

<pre><code>DB::beginTransaction();
</code></pre>

<p>You can rollback a transaction via the <code>rollback</code> method:</p>

<pre><code>DB::rollback();
</code></pre>

<p>Lastly, you can commit a transaction via the <code>commit</code> method:</p>

<pre><code>DB::commit();
</code></pre>

<p><a name="accessing-connections"></a></p>

<h2>Accessing Connections</h2>

<p>When using multiple connections, you may access them via the <code>DB::connection</code> method:</p>

<pre><code>$users = DB::connection('foo')-&gt;select(...);
</code></pre>

<p>You may also access the raw, underlying PDO instance:</p>

<pre><code>$pdo = DB::connection()-&gt;getPdo();
</code></pre>

<p>Sometimes you may need to reconnect to a given database:</p>

<pre><code>DB::reconnect('foo');
</code></pre>

<p>If you need to disconnect from the given database due to exceeding the underyling PDO instance's <code>max_connections</code> limit, use the <code>disconnect</code> method:</p>

<pre><code>DB::disconnect('foo');
</code></pre>

<p><a name="query-logging"></a></p>

<h2>Query Logging</h2>

<p>By default, Laravel keeps a log in memory of all queries that have been run for the current request. However, in some cases, such as when inserting a large number of rows, this can cause the application to use excess memory. To disable the log, you may use the <code>disableQueryLog</code> method:</p>

<pre><code>DB::connection()-&gt;disableQueryLog();
</code></pre>

<p>To get an array of the executed queries, you may use the <code>getQueryLog</code> method:</p>

<pre><code>   $queries = DB::getQueryLog();
</code></pre>
                    </div>
                    <!-- /docs content -->

                </article>
    	    </section>
    	    <!-- /docs -->

        </div>
    	<!-- /content -->

        <!-- footer -->
        <footer id="foot" class="textcenter">
            <div class="boxed">

                <!-- nav -->
                <nav id="secondary">
                    <div id="logo-foot">
        	           <a href="http://laravel.com/"><img src="../assets/img/logo-foot.png" alt="Laravel" /></a>
        	        </div>
                    <ul>
                        <li><a href="http://laravel.com/">Welcome</a></li>
                        <li class="current-item"><a href="../docs.html" title="Documentation">Documentation</a></li>
                        <li><a href="../docs.html" title="Laravel Framework API">API</a></li>
                        <li><a href="https://github.com/laravel/laravel" title="Github">Github</a></li>
                        <li><a href="http://forums.laravel.io/" title="Laravel Forums">Forums</a></li>
                        <li><a href="http://twitter.com/laravelphp" title="Laravel on Twitter">Twitter</a></li>
                    </ul>
                </nav>
                <!-- /nav -->

            </div>
        </footer>
        <!-- /footer -->

        <!-- to the top -->
        <div id="top">
            <a href="#index" title="Back to the top">
                <i class="icon-chevron-up"></i>
            </a>
        </div>
        <!-- /to the top -->

    </div>
    <!-- /wrapper -->

    <!-- copyright -->
    <section id="copyright" class="textcenter">
        <div class="boxed">
            <div class="animated slideInLeft">Laravel is a trademark of Taylor Otwell. Copyright &copy; <a href="http://twitter.com/taylorotwell" title="Taylor Otwell" target="_blank">Taylor Otwell</a>. Website built with &hearts; <a href="http://ikreativ.com/" title="iKreativ" target="_blank">iKreativ</a>.</div>
        </div>
    </section>
    <!-- /copyright -->

</body>

<!-- Mirrored from laravel.com/docs/database by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 14 Jan 2014 00:41:02 GMT -->
</html>
